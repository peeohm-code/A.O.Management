{
  "typescript_errors": {
    "total_errors": 41,
    "files_with_errors": 13,
    "errors_by_file": {
      "client/src/pages/NewDashboard.tsx": [
        {
          "line": 61,
          "column": 67,
          "code": "TS2339",
          "message": "Property 'stats' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ getStats: QueryProcedure<{ input: void; output: { projectStats: { total: number; ... 7 more ...; onTrack: number; }; ... 6 more ...; trends: { ...; }; }; meta: object; }>; ... 4 m...'."
        },
        {
          "line": 63,
          "column": 20,
          "code": "TS2551",
          "message": "Property 'recentActivities' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ getStats: QueryProcedure<{ input: void; output: { projectStats: { total: number; ... 7 more ...; onTrack: number; }; ... 6 more ...; trends: { ...; }; }; meta: object; }>; ... 4 m...'. Did you mean 'getRecentActivities'?"
        },
        {
          "line": 65,
          "column": 20,
          "code": "TS2339",
          "message": "Property 'taskStatusDistribution' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ getStats: QueryProcedure<{ input: void; output: { projectStats: { total: number; ... 7 more ...; onTrack: number; }; ... 6 more ...; trends: { ...; }; }; meta: object; }>; ... 4 m...'."
        },
        {
          "line": 67,
          "column": 20,
          "code": "TS2339",
          "message": "Property 'defectSeverityDistribution' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ getStats: QueryProcedure<{ input: void; output: { projectStats: { total: number; ... 7 more ...; onTrack: number; }; ... 6 more ...; trends: { ...; }; }; meta: object; }>; ... 4 m...'."
        },
        {
          "line": 69,
          "column": 20,
          "code": "TS2339",
          "message": "Property 'projectProgress' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ getStats: QueryProcedure<{ input: void; output: { projectStats: { total: number; ... 7 more ...; onTrack: number; }; ... 6 more ...; trends: { ...; }; }; meta: object; }>; ... 4 m...'."
        },
        {
          "line": 407,
          "column": 36,
          "code": "TS2339",
          "message": "Property 'completionPercentage' does not exist on type 'ProjectProgress'."
        },
        {
          "line": 414,
          "column": 47,
          "code": "TS2339",
          "message": "Property 'completionPercentage' does not exist on type 'ProjectProgress'."
        }
      ],
      "client/src/pages/QCInspection.tsx": [
        {
          "line": 86,
          "column": 45,
          "code": "TS2554",
          "message": "Expected 1-2 arguments, but got 0."
        },
        {
          "line": 185,
          "column": 51,
          "code": "TS2339",
          "message": "Property 'assignChecklistToTask' does not exist on type 'DecorateRouterRecord<{ ctx: TrpcContext; meta: object; errorShape: DefaultErrorShape; transformer: true; }, DecorateCreateRouterOptions<{ templates: QueryProcedure<{ input: void; output: { preExecution: any[]; inProgress: any[]; postExecution: any[]; }; meta: object; }>; ... 22 more ...; getAllTaskChecklists: QueryP...'."
        },
        {
          "line": 1036,
          "column": 23,
          "code": "TS2339",
          "message": "Property 'filter' does not exist on type '{ items: any[]; pagination: { currentPage: number; pageSize: number; totalItems: number; totalPages: number; hasMore: boolean; hasPrevious: boolean; }; }'."
        }
      ],
      "client/src/pages/Reports.tsx": [
        {
          "line": 58,
          "column": 29,
          "code": "TS2339",
          "message": "Property 'items' does not exist on type '{ id: number; projectId: number; taskId: number; checklistItemResultId: number | null; title: string; description: string | null; photoUrls: string | null; status: \"in_progress\" | \"reported\" | \"analysis\" | \"resolved\" | \"pending_reinspection\" | \"closed\"; ... 28 more ...; escalation: string | null; }[]'."
        },
        {
          "line": 68,
          "column": 39,
          "code": "TS2339",
          "message": "Property 'items' does not exist on type '{ id: number; projectId: number; taskId: number; checklistItemResultId: number | null; title: string; description: string | null; photoUrls: string | null; status: \"in_progress\" | \"reported\" | \"analysis\" | \"resolved\" | \"pending_reinspection\" | \"closed\"; ... 28 more ...; escalation: string | null; }[]'."
        }
      ],
      "client/src/pages/RoleTemplates.tsx": [
        {
          "line": 79,
          "column": 39,
          "code": "TS2353",
          "message": "Object literal may only specify known properties, and 'templateId' does not exist in type '{ id: number; }'."
        }
      ],
      "client/src/pages/Tasks.tsx": [
        {
          "line": 744,
          "column": 34,
          "code": "TS2552",
          "message": "Cannot find name 'setLocation'. Did you mean 'useLocation'?"
        }
      ],
      "client/src/pages/Templates.tsx": [
        {
          "line": 1,
          "column": 10,
          "code": "TS2300",
          "message": "Duplicate identifier 'useAuth'."
        },
        {
          "line": 35,
          "column": 10,
          "code": "TS2300",
          "message": "Duplicate identifier 'useAuth'."
        }
      ],
      "server/_core/virusScanner.ts": [
        {
          "line": 1,
          "column": 22,
          "code": "TS7016",
          "message": "Could not find a declaration file for module 'clamscan'. '/home/ubuntu/construction_management_app/node_modules/.pnpm/clamscan@2.4.0/node_modules/clamscan/index.js' implicitly has an 'any' type."
        }
      ],
      "server/activityLogExport.ts": [
        {
          "line": 61,
          "column": 23,
          "code": "TS2339",
          "message": "Property 'entityType' does not exist on type 'ActivityLogWithUser'."
        },
        {
          "line": 62,
          "column": 21,
          "code": "TS2339",
          "message": "Property 'entityId' does not exist on type 'ActivityLogWithUser'."
        }
      ],
      "server/db.ts": [
        {
          "line": 70,
          "column": 7,
          "code": "TS2322",
          "message": "Type 'MySql2Database<Record<string, unknown>> & { $client: Pool; }' is not assignable to type '(MySql2Database<Record<string, unknown>> & { $client: Pool; }) | null'."
        },
        {
          "line": 1067,
          "column": 5,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 1542,
          "column": 35,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 1923,
          "column": 5,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 2107,
          "column": 35,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 2372,
          "column": 48,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 3550,
          "column": 8,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 3581,
          "column": 27,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 7130,
          "column": 30,
          "code": "TS2339",
          "message": "Property 'insertId' does not exist on type 'MySqlRawQueryResult'."
        },
        {
          "line": 7234,
          "column": 65,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 7259,
          "column": 15,
          "code": "TS2769",
          "message": "No overload matches this call."
        },
        {
          "line": 7261,
          "column": 37,
          "code": "TS2551",
          "message": "Property 'reinspectedAt' does not exist on type 'MySqlTableWithColumns<{ name: \"taskChecklists\"; schema: undefined; columns: { id: MySqlColumn<{ name: \"id\"; tableName: \"taskChecklists\"; dataType: \"number\"; columnType: \"MySqlInt\"; data: number; driverParam: string | number; ... 8 more ...; generated: undefined; }, {}, {}>; ... 14 more ...; updatedAt: MySqlColumn<.....'. Did you mean 'inspectedAt'?"
        },
        {
          "line": 7282,
          "column": 40,
          "code": "TS2339",
          "message": "Property 'escalateToUserIds' does not exist on type '{ id: number; name: string; description: string | null; eventType: \"failed_inspection\" | \"unresolved_defect\" | \"overdue_task\"; thresholdValue: number; thresholdUnit: \"hours\" | \"days\"; ... 5 more ...; updatedAt: Date; }'."
        },
        {
          "line": 7332,
          "column": 40,
          "code": "TS2339",
          "message": "Property 'escalateToUserIds' does not exist on type '{ id: number; name: string; description: string | null; eventType: \"failed_inspection\" | \"unresolved_defect\" | \"overdue_task\"; thresholdValue: number; thresholdUnit: \"hours\" | \"days\"; ... 5 more ...; updatedAt: Date; }'."
        },
        {
          "line": 7356,
          "column": 26,
          "code": "TS2339",
          "message": "Property 'dueDate' does not exist on type 'MySqlTableWithColumns<{ name: \"tasks\"; schema: undefined; columns: { id: MySqlColumn<{ name: \"id\"; tableName: \"tasks\"; dataType: \"number\"; columnType: \"MySqlInt\"; data: number; driverParam: string | number; notNull: true; hasDefault: true; ... 6 more ...; generated: undefined; }, {}, {}>; ... 15 more ...; escalation...'."
        },
        {
          "line": 7362,
          "column": 24,
          "code": "TS2339",
          "message": "Property 'dueDate' does not exist on type 'MySqlTableWithColumns<{ name: \"tasks\"; schema: undefined; columns: { id: MySqlColumn<{ name: \"id\"; tableName: \"tasks\"; dataType: \"number\"; columnType: \"MySqlInt\"; data: number; driverParam: string | number; notNull: true; hasDefault: true; ... 6 more ...; generated: undefined; }, {}, {}>; ... 15 more ...; escalation...'."
        },
        {
          "line": 7380,
          "column": 40,
          "code": "TS2339",
          "message": "Property 'escalateToUserIds' does not exist on type '{ id: number; name: string; description: string | null; eventType: \"failed_inspection\" | \"unresolved_defect\" | \"overdue_task\"; thresholdValue: number; thresholdUnit: \"hours\" | \"days\"; ... 5 more ...; updatedAt: Date; }'."
        },
        {
          "line": 7423,
          "column": 9,
          "code": "TS2322",
          "message": "Type '\"escalation\"' is not assignable to type '\"task_assigned\" | \"task_status_changed\" | \"task_deadline_approaching\" | \"task_overdue\" | \"task_progress_updated\" | \"task_comment_mention\" | \"inspection_requested\" | \"inspection_completed\" | ... 22 more ... | \"system_health_info\"'."
        }
      ],
      "server/db/client.ts": [
        {
          "line": 42,
          "column": 7,
          "code": "TS2322",
          "message": "Type 'MySql2Database<Record<string, unknown>> & { $client: Pool; }' is not assignable to type '(MySql2Database<Record<string, unknown>> & { $client: Pool; }) | null'."
        }
      ],
      "server/services/notification.service.ts": [
        {
          "line": 145,
          "column": 19,
          "code": "TS2345",
          "message": "Argument of type '{ userId: number; id?: number | undefined; createdAt?: Date | undefined; title: string; type: \"task_assigned\" | \"task_status_changed\" | \"task_deadline_approaching\" | \"task_overdue\" | ... 26 more ... | \"system_health_info\"; ... 5 more ...; isRead?: number | undefined; }[]' is not assignable to parameter of type 'MySqlTable<TableConfig>'."
        }
      ],
      "server/utils/transaction.ts": [
        {
          "line": 63,
          "column": 77,
          "code": "TS2345",
          "message": "Argument of type 'unknown' is not assignable to parameter of type 'string | undefined'."
        }
      ],
      "vite.config.ts": [
        {
          "line": 111,
          "column": 3,
          "code": "TS2769",
          "message": "No overload matches this call."
        }
      ]
    },
    "error_types": {
      "TS2339": {
        "count": 18,
        "description": "Property 'stats' does not exist on type 'DecorateRouterRecord<{ ctx",
        "files": [
          "client/src/pages/NewDashboard.tsx",
          "client/src/pages/QCInspection.tsx",
          "client/src/pages/Reports.tsx",
          "server/activityLogExport.ts",
          "server/db.ts"
        ]
      },
      "TS2551": {
        "count": 2,
        "description": "Property 'recentActivities' does not exist on type 'DecorateRouterRecord<{ ctx",
        "files": [
          "client/src/pages/NewDashboard.tsx",
          "server/db.ts"
        ]
      },
      "TS2554": {
        "count": 1,
        "description": "Expected 1-2 arguments, but got 0.",
        "files": [
          "client/src/pages/QCInspection.tsx"
        ]
      },
      "TS2353": {
        "count": 1,
        "description": "Object literal may only specify known properties, and 'templateId' does not exist in type '{ id",
        "files": [
          "client/src/pages/RoleTemplates.tsx"
        ]
      },
      "TS2552": {
        "count": 1,
        "description": "Cannot find name 'setLocation'. Did you mean 'useL",
        "files": [
          "client/src/pages/Tasks.tsx"
        ]
      },
      "TS2300": {
        "count": 2,
        "description": "Duplicate identifier 'useAuth'.",
        "files": [
          "client/src/pages/Templates.tsx"
        ]
      },
      "TS7016": {
        "count": 1,
        "description": "Could not find a declaration file for module 'clam",
        "files": [
          "server/_core/virusScanner.ts"
        ]
      },
      "TS2322": {
        "count": 3,
        "description": "Type 'MySql2Database<Record<string, unknown>> & { $client",
        "files": [
          "server/db.ts",
          "server/db/client.ts"
        ]
      },
      "TS2769": {
        "count": 10,
        "description": "No overload matches this call.",
        "files": [
          "server/db.ts",
          "vite.config.ts"
        ]
      },
      "TS2345": {
        "count": 2,
        "description": "Argument of type '{ userId",
        "files": [
          "server/services/notification.service.ts",
          "server/utils/transaction.ts"
        ]
      }
    }
  },
  "runtime_errors": {
    "total_runtime_errors": 2,
    "errors": [
      {
        "type": "database",
        "severity": "high",
        "message": "Field 'userId' doesn't have a default value",
        "location": "notifications table",
        "cause": "Missing userId in notification creation",
        "impact": "Notification system fails silently",
        "fix": "Ensure userId is always provided when creating notifications"
      },
      {
        "type": "trpc",
        "severity": "medium",
        "message": "Property does not exist on type",
        "location": "Multiple frontend pages",
        "cause": "tRPC procedures not matching frontend expectations",
        "impact": "TypeScript errors, potential runtime failures",
        "fix": "Sync tRPC router definitions with frontend usage"
      }
    ]
  },
  "test_failures": {
    "total_tests": 212,
    "passed": 154,
    "failed": 32,
    "skipped": 26,
    "pass_rate": 72.6,
    "main_issues": [
      {
        "type": "mock_setup",
        "count": 15,
        "severity": "medium",
        "description": "Mock database setup ไม่สมบูรณ์",
        "example": "tx.insert(...).values is not a function",
        "impact": "Service layer tests fail",
        "fix": "ปรับปรุง mock database setup ให้ครบถ้วน"
      },
      {
        "type": "security_tests",
        "count": 8,
        "severity": "low",
        "description": "Security test expectations ไม่ตรง",
        "example": "expect 403 but got 400/413",
        "impact": "Security validation tests fail",
        "fix": "อัปเดต test expectations ให้ตรงกับ actual behavior"
      },
      {
        "type": "transaction_tests",
        "count": 9,
        "severity": "medium",
        "description": "Transaction rollback tests ล้มเหลว",
        "example": "Transaction mock incomplete",
        "impact": "Transaction tests fail",
        "fix": "แก้ไข transaction mock ให้สมบูรณ์"
      }
    ]
  },
  "categorized_issues": {
    "critical": {
      "description": "ปัญหาที่ต้องแก้ไขทันที - กระทบการใช้งานจริง",
      "issues": [
        {
          "id": "CRIT-001",
          "title": "Notification Creation Fails",
          "description": "Field 'userId' doesn't have a default value",
          "impact": "ระบบแจ้งเตือนไม่ทำงาน",
          "affected": "Task overdue notifications, escalations",
          "priority": "P0",
          "estimated_effort": "2 hours"
        }
      ]
    },
    "high": {
      "description": "ปัญหาสำคัญ - ควรแก้ไขเร็วที่สุด",
      "issues": [
        {
          "id": "HIGH-001",
          "title": "Monolithic Backend Files",
          "description": "server/routers.ts (3,937 lines) และ server/db.ts (7,626 lines)",
          "impact": "ยากต่อการ maintain, debug, และ scale",
          "affected": "ทั้งระบบ backend",
          "priority": "P1",
          "estimated_effort": "2-3 weeks"
        },
        {
          "id": "HIGH-002",
          "title": "Large Frontend Components",
          "description": "6 pages มีขนาด > 800 บรรทัด",
          "impact": "ยากต่อการ maintain และ test",
          "affected": "Defects.tsx (1,867), DefectDetail.tsx (1,731), etc.",
          "priority": "P1",
          "estimated_effort": "1-2 weeks"
        },
        {
          "id": "HIGH-003",
          "title": "TypeScript Errors",
          "description": "41 TypeScript errors",
          "impact": "Type safety ลดลง, potential runtime errors",
          "affected": "Multiple files",
          "priority": "P1",
          "estimated_effort": "1 week"
        }
      ]
    },
    "medium": {
      "description": "ปัญหาที่ควรปรับปรุง - ไม่กระทบการใช้งานโดยตรง",
      "issues": [
        {
          "id": "MED-001",
          "title": "Test Failures",
          "description": "32 failing tests (72.6% pass rate)",
          "impact": "ความมั่นใจในโค้ดลดลง",
          "affected": "Test suite",
          "priority": "P2",
          "estimated_effort": "1 week"
        },
        {
          "id": "MED-002",
          "title": "Too Many State Variables",
          "description": "หลาย components มี useState > 10",
          "impact": "Component complexity สูง",
          "affected": "Multiple pages",
          "priority": "P2",
          "estimated_effort": "3-5 days"
        },
        {
          "id": "MED-003",
          "title": "Missing tRPC Procedures",
          "description": "Frontend เรียกใช้ procedures ที่ไม่มีใน backend",
          "impact": "TypeScript errors, potential runtime errors",
          "affected": "Dashboard, QCInspection, Reports pages",
          "priority": "P2",
          "estimated_effort": "2-3 days"
        }
      ]
    },
    "low": {
      "description": "ปัญหาเล็กน้อย - ปรับปรุงเมื่อมีเวลา",
      "issues": [
        {
          "id": "LOW-001",
          "title": "Code Duplication",
          "description": "มี patterns ที่ซ้ำกันในหลาย components",
          "impact": "Maintenance overhead",
          "affected": "Multiple components",
          "priority": "P3",
          "estimated_effort": "1 week"
        },
        {
          "id": "LOW-002",
          "title": "Missing Component Reusability",
          "description": "ยังไม่มี shared components สำหรับ common patterns",
          "impact": "Code duplication, inconsistent UI",
          "affected": "Frontend",
          "priority": "P3",
          "estimated_effort": "1 week"
        }
      ]
    }
  },
  "summary": {
    "total_typescript_errors": 41,
    "total_runtime_errors": 2,
    "total_test_failures": 32,
    "critical_issues": 1,
    "high_priority_issues": 3,
    "medium_priority_issues": 3,
    "low_priority_issues": 2,
    "total_issues": 9
  }
}